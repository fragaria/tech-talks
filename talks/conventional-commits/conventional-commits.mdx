import { Box, Text } from "theme-ui";

import { default as fragaria } from "@tech-talks/common/theme";
import BaseLayout from "@tech-talks/common/layouts/BaseLayout";
import IntroLayout from "@tech-talks/common/layouts/IntroLayout";
import KeyStatementLayout from "@tech-talks/common/layouts/KeyStatementLayout";
import FinalLayout from "@tech-talks/common/layouts/FinalLayout";

import clutter from "./clutter.png";
import ordered from "./ordered.png";
import commitizen from "./commitizen.png";

export const theme = fragaria

<Head>
  <title>Conventional commits | Fragaria tech talks</title>
  <link rel="preload" href="https://res.cloudinary.com/fragaria/raw/upload/v1534234755/fragaria.cz/fonts/TriviaGroteskN2-Bold.woff" as="font" type="font/woff" crossorigin />
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap" rel="stylesheet" />
</Head>

<IntroLayout author="Filip VaÅ™echa">Conventional commits</IntroLayout>

---

<BaseLayout title="What?">


A [specification](https://www.conventionalcommits.org/) for adding human and machine readable meaning to commit messages.

<div style={{
  display: "flex",
  flexDirection: "column",
  width: "100%",
}}>
<div style={{height: "40vh", width: "100%", overflow: "hidden"}}>
Turn this:

<Image src={clutter} />

</div>

<div style={{height: "40vh", width: "100%", overflow: "hidden", marginTop: "1rem"}}>
... into this:

<Image src={ordered} />

</div>
</div>

</BaseLayout>

---

<BaseLayout title="Motivation">

<ol>

<Steps>

<li>Assemble messages in an unified manner.</li>
<li>More focused commits: avoid tons of unrelated changes in a single batch.</li>
<li>Categorize changes.</li>

</Steps>

</ol>

</BaseLayout>

---

<BaseLayout title="Benefits">

<Steps>

<div>

## Can be easily enforced

Lint your commit messages in the same fashion you lint your code.

</div>

<div>

## Easier to contribute

Less guesswork means the chances to maintain your Git history perfectly readable are bigger.

</div>

<div>

## Machine-readable

- Create version bumps automatically.
- Generate changelogs.
- Trigger CI/CD processes according to the nature of the change.

</div>

</Steps>

</BaseLayout>

---

<KeyStatementLayout>

# The standard

</KeyStatementLayout>

---

<BaseLayout title="Commit structure">

```
<type>[optional scope]: <description>

[optional body]

[optional footer]
```

- `type`: Define change categories.
- `scope`: Specify which part of the app was modified.
- `description`: A short description.
- `body`: *Optional*. A more through description. Should contain `BREAKING CHANGE` memo if this modifies external APIs.
- `footer`: *Optional*. Useful for tagging, mentioning related issues and so on.

</BaseLayout>

---

<BaseLayout title="Commit types">

Essential for categorization. Base spec requires `fix` and `feat`. However, [more categories](https://github.com/conventional-changelog/commitlint/tree/master/%40commitlint/config-conventional) are usually used.

<Box bg="gray700" p={2}>

- <Text color="primary" variant="code" as="span">build</Text>: Changes that affect the build system or external dependencies (example scopes: gulp, broccoli, npm).
- <Text color="primary" variant="code" as="span">ci</Text>: Changes to CI configuration files and scripts (example scopes: Travis, Circle, BrowserStack, SauceLabs).
- <Text color="primary" variant="code" as="span">docs</Text>: Documentation only changes.
- <Text color="primary" variant="code" as="span">feat</Text>: A new feature.
- <Text color="primary" variant="code" as="span">fix</Text>: A bug fix.
- <Text color="primary" variant="code" as="span">perf</Text>: A code change that improves performance.
- <Text color="primary" variant="code" as="span">refactor</Text>: A code change that neither fixes a bug nor adds a feature.
- <Text color="primary" variant="code" as="span">style</Text>: Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc).
- <Text color="primary" variant="code" as="span">test</Text>: Adding missing tests or correcting existing tests.

</Box>

</BaseLayout>

---

<KeyStatementLayout>

# Examples

</KeyStatementLayout>

---

<BaseLayout title="Breaking change">

```
feat: allow provided config object to extend other configs

BREAKING CHANGE: `extends` key in config file is now used for extending other config files
```

Will bump the major version once new release is issued when using Standard Version.

</BaseLayout>

---

<BaseLayout title="No body">

```
docs: correct spelling of CHANGELOG
```

- Not really different from what most people use.
- There doesn't have to be much overhead added.

</BaseLayout>

---

<BaseLayout title="Scope use">

```
feat(lang): added polish language
```

Helps readers to locate where changes occured. Specifying allowed scopes is up to the repository manager.

</BaseLayout>

---

<BaseLayout title="Issue reference">

```
fix: minor typos in code

see the issue for details on the typos fixed

fixes issue #12
```

References can be parsed by CI/CD. Think issue auto-close, deployment triggers etc.

</BaseLayout>

---

<BaseLayout title="Tools">

<Steps>

<div>

### [Commitlint](https://github.com/conventional-changelog/commitlint)

Check if the commit message meets the conventional commit standard.

</div>

<div>

### [Commitizen CLI](https://github.com/commitizen/cz-cli)

A CLI utility which helps you to assemble proper commit message. Can be easily configured to follow conventional commit standard.


</div>

<div>

### [Standard Version](https://github.com/conventional-changelog/standard-version)

Generates `CHANGELOG` and also bumps versions (in `package.json` etc.) according to what changed from the last release. Clever enough to cover whole semver as it recognizes feature/fix/breaking change.

</div>

</Steps>

</BaseLayout>

---

<BaseLayout title="Commitizen">

<Image src={commitizen} style={{backgroundSize: "contain", height: "50vh"}} />

</BaseLayout>

---

<FinalLayout>

That's it!

Thanks for your time.

</FinalLayout>
